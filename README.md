#  Аналіз відправлених email-повідомлень за місяцями  

##  Опис  
Цей SQL-запит аналізує активність email-розсилок у розрізі акаунтів та місяців. Він дозволяє оцінити частку кожного акаунта у загальному обсязі відправлених листів, а також визначити перший та останній дні розсилок у кожному місяці.  

##  Основні етапи  
1. **Формування базових даних (`t_1`)**  
   - Обчислення дати відправки (`sent_day`) на основі дати сесії та дати відправки листа.  
   - Округлення дати до місяця (`sent_month`).  
   - Підрахунок кількості відправлених листів:  
     - Для кожного акаунта у межах місяця (`cnt_msg`).  
     - Для всіх акаунтів у межах місяця (`msg_month`).  

2. **Визначення діапазону дат розсилки (`t_2`)**  
   - Визначення першого (`first_sent_date`) та останнього (`last_sent_date`) дня відправки листів у кожному місяці.  

3. **Обчислення частки відправлених листів (`sent_msg_percent`)**  
   - Обчислення відсотка повідомлень кожного акаунта у загальному обсязі розсилки за місяць.  

##  Використані технології  
- **SQL** (CTE, `DATE_ADD`, `DATE_TRUNC`, віконні функції `COUNT`, `MIN`, `MAX`)  
- **Google BigQuery** 

##  Результат  
Запит повертає:  
- Місяць відправки (`sent_month`)  
- ID акаунта (`id_account`)  
- Частку відправлених повідомлень у межах місяця (`sent_msg_percent`)  
- Перший та останній день розсилки у місяці  

Ці дані можуть використовуватись для аналізу активності користувачів у розсилках та ефективності email-кампаній.  

